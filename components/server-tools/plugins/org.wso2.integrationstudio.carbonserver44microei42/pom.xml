<?xml version="1.0" encoding="UTF-8"?>
<project xmlns="http://maven.apache.org/POM/4.0.0"
         xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
         xsi:schemaLocation="http://maven.apache.org/POM/4.0.0 http://maven.apache.org/maven-v4_0_0.xsd">
    <parent>
        <artifactId>wso2-integrationstudio-server-plugins</artifactId>
        <groupId>org.wso2.integrationstudio</groupId>
        <version>8.2.0-SNAPSHOT</version>
        <relativePath>../pom.xml</relativePath>
    </parent>
    <modelVersion>4.0.0</modelVersion>
    <artifactId>org.wso2.integrationstudio.carbonserver44microei42</artifactId>
    <packaging>eclipse-plugin</packaging>
    <name>Integration Studio Enterprise Integrator (Carbon 4.4 based)</name>
    <build>
	<plugins>
		<plugin>
			<groupId>com.googlecode.maven-download-plugin</groupId>
			<artifactId>download-maven-plugin</artifactId>
			<version>${maven.download.plugin}</version>
			<executions>
				<execution>
					<id>download-mi-runtime</id>
					<phase>initialize</phase>
					<goals>
						<goal>wget</goal>
					</goals>
					<configuration>
						<url>https://github.com/rosensilva/micro-integrator/releases/download/v4.2.0-rc/wso2mi-4.2.0-rc.zip</url>
						<unpack>false</unpack>
						<outputDirectory>${project.basedir}/resources/server/</outputDirectory>
					</configuration>
				</execution>
				<execution>
					<id>download-mi-update-scripts</id>
					<phase>initialize</phase>
					<goals>
						<goal>wget</goal>
					</goals>
					<configuration>
						<url>https://product-dist.wso2.com/downloads/update-tool/release/update.zip</url>
						<unpack>false</unpack>
						<outputDirectory>${project.basedir}/resources/server/</outputDirectory>
					</configuration>
				</execution>
			</executions>
		</plugin>
		<plugin>
			<artifactId>exec-maven-plugin</artifactId>
			<groupId>org.codehaus.mojo</groupId>
			<version>${org.codehaus.mojo.exec.maven.plugin}</version>
			<executions>
				<execution>
					<id>script-chmod</id>
					<phase>install</phase>
					<goals>
						<goal>exec</goal>
					</goals>
					<configuration>
						<executable>chmod</executable>
						<arguments>
							<argument>+x</argument>
							<argument>${project.basedir}/resources/server/update.zip</argument>
						</arguments>
					</configuration>
				</execution>
				<execution>
					<id>Run-inplace-mi-update-tool</id>
					<phase>initialize</phase>
					<goals>
						<goal>exec</goal>
					</goals>
					<configuration>
						<commandlineArgs>${WSO2_USERNAME} ${WSO2_PASSWORD} ${mi.product.version}</commandlineArgs>
						<executable>${project.basedir}/resources/scripts/wso2-update.sh</executable>
					</configuration>
				</execution>
				<execution>
					<id>change-mi-deployment-toml</id>
					<phase>initialize</phase>
					<goals>
						<goal>exec</goal>
					</goals>
					<configuration>
						<executable>${project.basedir}/resources/scripts/configure-mi-script.sh</executable>
					</configuration>
				</execution>
			</executions>
		</plugin>
	</plugins>
</build>
</project>
